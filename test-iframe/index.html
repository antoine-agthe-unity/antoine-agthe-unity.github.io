<html>
  <body>
    <div id="console" style="width: 100vw; height: 100vh"></div>
    <script>

      function log(message) {
        var div = document.getElementById("console");
        div.innerHTML = `<p>${message}</p>${div.innerHTML}`;
      }
      
      function receiveMessage(message) {
        console.log({origin: location.origin, message: message});        
        log(message.data);
        
        if(message.source == parent) {
          console.log("Message source is parent");
        }
      }
      
      var messageId = 0;
      
      function sendMessage() {
        console.log(`Try to send message ${messageId} to parent`);

        var message = `Hello from child #${messageId++}`;
        parent.postMessage(message, "https://antoine-agthe.github.io");

        message = `Hello from child using * #${messageId++}`;
        parent.postMessage(message, "*");
      }
            
      window.addEventListener("message", receiveMessage, false);
      
      setInterval(sendMessage, 1000);
      
      try {
        log(`My location is ${window.location}`);
        log(`My parent location is ${window.parent.location}`);
        console.log(window.location);
        console.log(window.parent.location);
      }
      catch (error) {
        console.error({origin: location.origin, error: error});
      }
      
      function debugParent() {
        console.log(parent);
      }
    </script>
  </body>
</html>
